{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\vmage\\\\OneDrive\\\\Ruppin\\\\\\u05E9\\u05E0\\u05D4 \\u05D2\\\\\\u05E1\\u05DE\\u05E1\\u05D8\\u05E8 \\u05D1\\\\FinalProject\\\\react_native\\\\FunctionalComponents\\\\FCREgister.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { isValidElement } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { Text, Divider } from 'react-native-elements';\nimport headers from \"../helpers/messages.json\";\nimport FCHeader from \"./FCHeader\";\nimport StyleSheet from \"../Pages/PageStyle\";\nimport FCFacebookLogin from \"./FCFacBookLogin\";\nimport { Input, Button } from 'react-native-elements';\nimport helpers from \"../helpers/helperFunctions\";\nimport * as Animatable from 'react-native-animatable';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nexport default function FCREgister(_ref) {\n  var navigation = _ref.navigation;\n\n  var _React$useState = React.useState({\n    name: '',\n    email: '',\n    password: '',\n    confirmPassword: '',\n    picture: 'http://proj.ruppin.ac.il/bgroup15/prod/finalPics/avatar.jpg',\n    isEighteen: false,\n    isValidName: false,\n    isValidEmail: false,\n    isValidPassword: false,\n    isConfirmPassword: false,\n    isExists: false\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      user = _React$useState2[0],\n      setUser = _React$useState2[1];\n\n  var handleNameChange = function handleNameChange(val) {\n    if (val.trim().length >= 3) {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        name: val,\n        isValidName: true\n      }));\n    } else {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        name: val,\n        isValidName: false\n      }));\n    }\n  };\n\n  var handleEmailChange = function handleEmailChange(val) {\n    if (val.trim().length >= 3 && val.includes('@')) {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        email: val,\n        isValidEmail: true\n      }));\n    } else {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        email: val,\n        isValidEmail: false\n      }));\n    }\n  };\n\n  var handlePasswordChange = function handlePasswordChange(val) {\n    if (val.trim().length >= 4) {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        password: val,\n        isValidPassword: true\n      }));\n    } else {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        password: val,\n        isValidPassword: false\n      }));\n    }\n  };\n\n  var handleConfirmPasswordChange = function handleConfirmPasswordChange(val) {\n    if (val === user.password) {\n      setUser(_objectSpread(_objectSpread({}, user), {}, {\n        isConfirmPassword: true\n      }));\n    }\n  };\n\n  var handleSubmitNewUser = function handleSubmitNewUser() {\n    var temp, user1;\n    return _regeneratorRuntime.async(function handleSubmitNewUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(user.isValidName && user.isValidPassword && user.isValidEmail && user.isConfirmPassword)) {\n              _context.next = 18;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(checkEmailExists());\n\n          case 3:\n            temp = _context.sent;\n            console.log(temp);\n\n            if (user.isExists) {\n              _context.next = 15;\n              break;\n            }\n\n            console.log(\"isExists: \", user.isExists);\n            AddToDB();\n            _context.next = 10;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('login', JSON.stringify(user)).then(function () {\n              return console.log(\"user saved!\", user);\n            }));\n\n          case 10:\n            _context.next = 12;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('@login').then(function () {\n              console.log(\"GET ITEM\");\n            }));\n\n          case 12:\n            user1 = _context.sent;\n            _context.next = 16;\n            break;\n\n          case 15:\n            console.log(\"isExists: \", user.isExists);\n\n          case 16:\n            _context.next = 19;\n            break;\n\n          case 18:\n            Alert.alert(\"Problem !\");\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var checkEmailExists = function checkEmailExists() {\n    return _regeneratorRuntime.async(function checkEmailExists$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(fetch(helpers.getApi() + '/user/email?email=' + user.email, {\n              method: 'GET',\n              headers: new Headers({\n                'Content-Type': 'application/json; charset=UTF-8',\n                'Accept': 'application/json; charset=UTF-8'\n              })\n            }).then(function (res) {\n              if (res.ok) {\n                setUser(_objectSpread(_objectSpread({}, user), {}, {\n                  isExists: true\n                }));\n              } else {\n                setUser(_objectSpread(_objectSpread({}, user), {}, {\n                  isExists: false\n                }));\n              }\n            }));\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var goToLoginPage = function goToLoginPage() {\n    navigation.navigate('login');\n  };\n\n  var AddToDB = function AddToDB() {\n    var newUser;\n    return _regeneratorRuntime.async(function AddToDB$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            newUser = {\n              \"name\": user.name,\n              \"password\": user.password,\n              \"email\": user.email,\n              \"older\": 1,\n              \"picture\": user.picture\n            };\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(fetch(helpers.getApi() + '/Winery', {\n              method: 'POST',\n              body: JSON.stringify(newUser),\n              headers: new Headers({\n                'Content-Type': 'application/json; charset=UTF-8',\n                'Accept': 'application/json; charset=UTF-8'\n              })\n            }).then(function (res) {\n              return JSON.stringify(res);\n            }).then(function (result) {}, function (error) {\n              console.log(\"err post=\", error);\n            }));\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: StyleSheet.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 5\n    }\n  }, React.createElement(FCHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    h4: true,\n    style: StyleSheet.h4Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }\n  }, headers.createAccount)), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }\n  }, React.createElement(FCFacebookLogin, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  })), React.createElement(Divider, {\n    style: {\n      marginTop: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }\n  }, React.createElement(Input, {\n    placeholder: headers.insertName,\n    rightIcon: {\n      type: 'font-awesome',\n      name: 'user'\n    },\n    inputContainerStyle: StyleSheet.input,\n    onChangeText: function onChangeText(value) {\n      handleNameChange(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }), React.createElement(Input, {\n    placeholder: headers.insertEmail,\n    rightIcon: {\n      type: 'font-awesome',\n      name: 'envelope'\n    },\n    inputContainerStyle: StyleSheet.input,\n    onChangeText: function onChangeText(value) {\n      handleEmailChange(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }), React.createElement(Input, {\n    placeholder: headers.insertPassword,\n    rightIcon: {\n      type: 'font-awesome',\n      name: 'lock'\n    },\n    inputContainerStyle: StyleSheet.input,\n    onChangeText: function onChangeText(value) {\n      handlePasswordChange(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  }), React.createElement(Input, {\n    placeholder: headers.insertPasswordSecond,\n    rightIcon: {\n      type: 'font-awesome',\n      name: 'lock'\n    },\n    inputContainerStyle: StyleSheet.input,\n    onChangeText: function onChangeText(value) {\n      handleConfirmPasswordChange(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    style: {\n      flexDirection: 'column',\n      justifyContent: 'space-evenly',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }\n  }, React.createElement(Button, {\n    title: headers.createAccount,\n    buttonStyle: StyleSheet.button,\n    onPress: handleSubmitNewUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 11\n    }\n  }), React.createElement(Text, {\n    h5: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 11\n    }\n  }, headers.alreadyHave), React.createElement(Button, {\n    title: headers.login,\n    buttonStyle: StyleSheet.button,\n    onPress: goToLoginPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 11\n    }\n  }))));\n}","map":{"version":3,"sources":["C:/Users/vmage/OneDrive/Ruppin/שנה ג/סמסטר ב/FinalProject/react_native/FunctionalComponents/FCREgister.js"],"names":["React","isValidElement","Text","Divider","headers","FCHeader","StyleSheet","FCFacebookLogin","Input","Button","helpers","Animatable","AsyncStorage","FCREgister","navigation","useState","name","email","password","confirmPassword","picture","isEighteen","isValidName","isValidEmail","isValidPassword","isConfirmPassword","isExists","user","setUser","handleNameChange","val","trim","length","handleEmailChange","includes","handlePasswordChange","handleConfirmPasswordChange","handleSubmitNewUser","checkEmailExists","temp","console","log","AddToDB","setItem","JSON","stringify","then","getItem","user1","Alert","alert","fetch","getApi","method","Headers","res","ok","goToLoginPage","navigate","newUser","body","result","error","container","h4Text","createAccount","marginTop","insertName","type","input","value","insertEmail","insertPassword","insertPasswordSecond","flexDirection","justifyContent","alignItems","button","alreadyHave","login"],"mappings":"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","sourcesContent":["import React, { isValidElement } from 'react'\r\nimport { View, SafeAreaView, Alert } from 'react-native';\r\nimport { Text, Divider } from 'react-native-elements';\r\nimport headers from '../helpers/messages.json';\r\nimport FCHeader from './FCHeader';\r\nimport StyleSheet from '../Pages/PageStyle';\r\nimport FCFacebookLogin from './FCFacBookLogin';\r\nimport { Input, Button } from 'react-native-elements';\r\nimport helpers from '../helpers/helperFunctions';\r\nimport * as Animatable from 'react-native-animatable';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage'\r\n\r\nexport default function FCREgister({ navigation }) {\r\n  const [user, setUser] = React.useState({\r\n    name: '',\r\n    email: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n    picture: 'http://proj.ruppin.ac.il/bgroup15/prod/finalPics/avatar.jpg',\r\n    isEighteen: false, //over18\r\n    isValidName: false, //name validation\r\n    isValidEmail: false, //email validation\r\n    isValidPassword: false, //password validition\r\n    isConfirmPassword: false, //passwords match\r\n    isExists: false //exists in DB\r\n  });\r\n\r\n  const handleNameChange = (val) => {\r\n    if (val.trim().length >= 3) {\r\n      setUser({\r\n        ...user,\r\n        name: val,\r\n        isValidName: true\r\n      });\r\n    } else {\r\n      setUser({\r\n        ...user,\r\n        name: val,\r\n        isValidName: false\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleEmailChange = (val) => {\r\n    if (val.trim().length >= 3 && val.includes('@')) {\r\n      setUser({\r\n        ...user,\r\n        email: val,\r\n        isValidEmail: true\r\n      })\r\n    }\r\n    else {\r\n      setUser({\r\n        ...user,\r\n        email: val,\r\n        isValidEmail: false\r\n      })\r\n    }\r\n  };\r\n\r\n  const handlePasswordChange = (val) => {\r\n    if (val.trim().length >= 4) {\r\n      setUser({\r\n        ...user,\r\n        password: val,\r\n        isValidPassword: true\r\n      })\r\n    }\r\n    else {\r\n      setUser({\r\n        ...user,\r\n        password: val,\r\n        isValidPassword: false\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleConfirmPasswordChange = (val) => {\r\n    if (val === user.password) {\r\n      setUser({\r\n        ...user,\r\n        isConfirmPassword: true\r\n      });\r\n\r\n    }\r\n  };\r\n\r\n  const handleSubmitNewUser = async () => {\r\n    if (user.isValidName && user.isValidPassword && user.isValidEmail && user.isConfirmPassword) {\r\n      //Check email first - not duplicate.\r\n      const temp = await checkEmailExists();\r\n      console.log(temp);\r\n      if (!user.isExists) {\r\n        console.log(\"isExists: \", user.isExists);\r\n        //ADD TO DB\r\n        AddToDB();\r\n        //SaveToAsyncStorage\r\n        await AsyncStorage.setItem('login', JSON.stringify(user))\r\n          .then(() => console.log(\"user saved!\", user));\r\n        let user1 = await AsyncStorage.getItem('@login').then(\r\n          () => {\r\n            console.log(\"GET ITEM\")\r\n          }\r\n        );\r\n\r\n      }\r\n      else {\r\n        console.log(\"isExists: \", user.isExists);\r\n        //Alert message user exists\r\n      }\r\n    }\r\n    else {\r\n      Alert.alert(\"Problem !\");\r\n    }\r\n  }\r\n\r\n  //http://localhost:64023/api/user/email?email=asaf@gmail.com\r\n  const checkEmailExists = async () => {\r\n    await fetch(helpers.getApi() + '/user/email?email=' + user.email,\r\n      {\r\n        method: 'GET',\r\n        headers: new Headers({\r\n          'Content-Type': 'application/json; charset=UTF-8',\r\n          'Accept': 'application/json; charset=UTF-8',\r\n        })\r\n      })\r\n      .then(res => {\r\n        if (res.ok) {\r\n          setUser({\r\n            ...user,\r\n            isExists: true\r\n          })\r\n        }\r\n        else {\r\n          setUser({\r\n            ...user,\r\n            isExists: false\r\n          })\r\n        }\r\n      })\r\n  }\r\n\r\n  const goToLoginPage = () => {\r\n    navigation.navigate('login')\r\n  }\r\n\r\n  const AddToDB = async () => {\r\n    let newUser =\r\n    {\r\n      \"name\": user.name,\r\n      \"password\": user.password,\r\n      \"email\": user.email,\r\n      \"older\": 1,\r\n      \"picture\": user.picture\r\n    };\r\n\r\n    await fetch(helpers.getApi() + '/Winery',\r\n      {\r\n        method: 'POST',\r\n        body: JSON.stringify(newUser),\r\n        headers: new Headers({\r\n          'Content-Type': 'application/json; charset=UTF-8',\r\n          'Accept': 'application/json; charset=UTF-8',\r\n        })\r\n      })\r\n      .then(res => {\r\n        return JSON.stringify(res);\r\n      })\r\n      .then(\r\n        (result) => {\r\n          //console.log(\"result = \", result);\r\n        },\r\n        (error) => {\r\n          console.log(\"err post=\", error);\r\n        });\r\n  }\r\n\r\n\r\n  return (\r\n    <SafeAreaView style={StyleSheet.container}>\r\n      <FCHeader />\r\n      <View >\r\n        <Text h4 style={StyleSheet.h4Text}>{headers.createAccount}</Text>\r\n      </View>\r\n      <View>\r\n        <FCFacebookLogin />\r\n      </View>\r\n      <Divider style={{ marginTop: 10 }} />\r\n      <View>\r\n        <Input\r\n          placeholder={headers.insertName}\r\n          rightIcon={{ type: 'font-awesome', name: 'user' }}\r\n          inputContainerStyle={StyleSheet.input}\r\n          onChangeText={value => { handleNameChange(value) }}\r\n        />\r\n        <Input\r\n          placeholder={headers.insertEmail}\r\n          rightIcon={{ type: 'font-awesome', name: 'envelope' }}\r\n          inputContainerStyle={StyleSheet.input}\r\n          onChangeText={value => { handleEmailChange(value) }}\r\n\r\n        />\r\n        <Input\r\n          placeholder={headers.insertPassword}\r\n          rightIcon={{ type: 'font-awesome', name: 'lock' }}\r\n          inputContainerStyle={StyleSheet.input}\r\n          onChangeText={value => { handlePasswordChange(value) }}\r\n        />\r\n        <Input\r\n          placeholder={headers.insertPasswordSecond}\r\n          rightIcon={{ type: 'font-awesome', name: 'lock' }}\r\n          inputContainerStyle={StyleSheet.input}\r\n          onChangeText={value => { handleConfirmPasswordChange(value) }}\r\n\r\n        />\r\n        <View style={{ flexDirection: 'column', justifyContent: 'space-evenly', alignItems: 'center' }}>\r\n          <Button\r\n            title={headers.createAccount}\r\n            buttonStyle={StyleSheet.button}\r\n            onPress={handleSubmitNewUser}\r\n          />\r\n          <Text h5>{headers.alreadyHave}</Text>\r\n          <Button\r\n            title={headers.login}\r\n            buttonStyle={StyleSheet.button}\r\n            onPress={goToLoginPage}\r\n          />\r\n        </View>\r\n      </View>\r\n    </SafeAreaView>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}